---
title: "MBON SDG14 FKNMS Ecological Classifications"
author: "Megan Hepner"
date: "May 5, 2017"
output: html_document
---

## Sustainable Development Goal 

SDG14: Conserve and sustainably use the oceans, seas and marine resources
    + SDG14.2:VBy 2020, sustainably manage, and protect marine and coastal ecosystems to avoid significant adverse impacts, including by strengthening their resilience and take action for their restoration, to achieve healthy and productive oceans

## National Marine Sanctuary Condition Report Questions 

### Water Quality 
1. What is the eutrophic condition of the sanctuary waters and how is it changing?
2. Do sanctuary waters pose risks to human health and how are they changing?
3. Have recent changes in climate alter water conditions and how are they changing?
4. Are other stressors, individually or in combination, affecting water quality, and how are they changing?

### Habitat Resources 
5. What is the integrity of major habitat types and how are they changing?
6. What are contaminant concentrations in sanctuary habitats and how are they changing?

### Living Resources 
7. What is the status and trend of keystone and foundation species and how is it changing?
8. What is the status and trend of other focal species and how is it changing?
9. What is the status of non-indigenous species and how is it changing?
10. What is the status of biodiversity and how is it changing?

### Maritime Archeological Resources  
11. What is the archaeological integrity of known maritime archaeological resources and how is it changing? 
12. Do known maritime archaeological resources pose an environmental hazard and how is this threat changing?

### Human Demensions 
13. What are the levels of human activities that may adversely influence water quality and how are they changing? 
14. What are the levels of human activities that may adversely influence habitats and how are they changing?
15. What are the levels of human activities that may adversely influence living resource quality and how are they changing? 
16. What are the levels of human activities that may adversely influence maritime archaeological resource quality and how are they changing?
17. What are the states of influential human drivers and how are they changing?


## FKNMS Infographic data 

| Sanctuary Classification level | Icon                   | Metric                  | Dataset |  
|:-------------------------------|:-----------------------|:------------------------|:--------|
| Invasive species               | Lionfish               | abundance               | RVC     |
| Foundation species             | Stony coral            | percent cover & diseased| CREMP   |
|                                | Sea fan                | percent cover & diseased| CREMP   |
|                                | Macroalgae             | percent cover & diseased| CREMP   |             
|                                | Sponges                | percent cover & diseased| CREMP   |             
| Keystone species               | Long-spinned sea urchin| abundance               |         |
| Focal species                  | Caribbean spiny lobster| abundance               |         |
|                                | Queen Conch            | abundance               |         |
|                                | Sea turtles            | abundance               |         |
|                                | Herbivores             | abundance               | RVC     |
|                                | Exploited reef fish    | abundance               | RVC     |
|                                | Reef fish biodiversity | diversity index         | RVC     |


    
```{r librarys}

library(knitr)
library(tidyverse)
library(rvc)
library(vegan)
#library(rfishbase)

```

```{r call RVC data}

RVCdata_FK <- getRvcData(1999:2016, "FLA KEYS", server = 'https://www.sefsc.noaa.gov/rvc_analysis20/')
RVCdata_DT <- getRvcData(1999:2016, "FLA KEYS", server = 'https://www.sefsc.noaa.gov/rvc_analysis20/')

species_list <- RVCdata_FK$taxonomic_data %>%
  select(SPECIES_CD,FAMILY, SCINAME, COMNAME) %>%
  arrange(desc(FAMILY))

species_family_list <- unique(RVCdata_FK$taxonomic_data$FAMILY)
species_family_list[order(species_family_list)]

```

##Trophic groups
- Forage fish 
- Grouper
- Grunts
- Higher Level Reef Fish
- Hogfish
- Lionfish
- Opportunists 
- Parrotfish
- Rays
- Sea bass and Hamlets
- Sharks
- Small Reef Fish
- Snapper

#### Forage fish
```{r Forage fish}

forage_fish_spp_list= c("HYP HARR", "ATH STIP", "JEN SPE.", "HAR JAGU", "ANC LYOL", "INE VITT", "HEM BRAS", "SAR AURI", "HAR HUME", "CHR ATHE")

#abundance
forage_fk_abun = getDomainAbundance(RVCdata_FK, forage_fish_spp_list, merge_protected = F)
forage_dt_abun = getDomainAbundance(RVCdata_FK, forage_fish_spp_list, merge_protected = F)

#density
forage_fk_den = getDomainDensity(RVCdata_DT, forage_fish_spp_list, merge_protected = F)
forage_dt_den = getDomainDensity(RVCdata_DT, forage_fish_spp_list, merge_protected = F)

#shannon

#simpson 
```

#### Grouper
```{r Grouper}

grouper_spp_list= c("CEP CRUE", "MYC BONA", "EPI MORI", "EPI STRI", "EPI ITAJ", "CEP FULV", "MYC MICR", "MYC PHEN", "MYC VENE", "MYC INTE", "MYC TIGR", "EPI FLAV", "DER INER", "SRR SPE.", "Epi nive", "Myc acut")

#abundance
grouper_fk_abun = getDomainAbundance(RVCdata_FK, grouper_spp_list, merge_protected = F)
grouper_dt_abun = getDomainAbundance(RVCdata_FK, grouper_spp_list, merge_protected = F)

#density
grouper_fk_den = getDomainDensity(RVCdata_DT, grouper_spp_list, merge_protected = F)
grouper_dt_den = getDomainDensity(RVCdata_DT, grouper_spp_list, merge_protected = F)

```

#### Grunts 
```{r Grunts}

grunt_spp_list = c("HAE SCIU", "HAE AURO", "HAE PLUM", "HAE SPE.", "HAE FLAV", "HAE CHRY", "ANI VIRG","HAE MELA", "HAE CARB", "HAE PARR", "HAE STRI", "HAE MACR", "ANI SURI", "HAE ALBU")

#abundance
grunt_fk_abun = getDomainAbundance(RVCdata_FK, grunt_spp_list, merge_protected = F)
grunt_dt_abun = getDomainAbundance(RVCdata_FK, grunt_spp_list, merge_protected = F)

#density
grunt_fk_den = getDomainDensity(RVCdata_DT, grunt_spp_list, merge_protected = F)
grunt_dt_den = getDomainDensity(RVCdata_DT, grunt_spp_list, merge_protected = F)

```

#### Higher Level Reef Fish
```{r Higher Level Reef Fish}

higher_reef_spp_list = c()

#abundance
higher_reef_fk_abun = getDomainAbundance(RVCdata_FK, higher_reef_spp_list, merge_protected = F)
higher_reef_dt_abun = getDomainAbundance(RVCdata_FK, higher_reef_spp_list, merge_protected = F)
get
#density
higher_reef_fk_den = getDomainDensity(RVCdata_DT, higher_reef_spp_list, merge_protected = F)
higher_reef_dt_den = getDomainDensity(RVCdata_DT, higher_reef_spp_list, merge_protected = F)
```

#### Hogfish
```{r Hogfish}

hogfish_spp_list = c("LAC MAXI", "BOD RUFU", "BOD PULC")

#abundance
hogfish_fk_abun = getDomainAbundance(RVCdata_FK, hogfish_spp_list, merge_protected = F)
hogfish_dt_abun = getDomainAbundance(RVCdata_FK, hogfish_spp_list, merge_protected = F)

#density
hogfish_fk_den = getDomainDensity(RVCdata_DT, hogfish_spp_list, merge_protected = F)
hogfish_dt_den = getDomainDensity(RVCdata_DT, hogfish_spp_list, merge_protected = F)

```

#### Lionfish
```{r Lionfish}

#"PTE VOLI" - lionfish

#abundance
lionfish_fk_abun = getDomainAbundance(RVCdata_FK, "PTE VOLI", merge_protected = F)
lionfish_dt_abun = getDomainAbundance(RVCdata_FK, "PTE VOLI", merge_protected = F)

#density
lionfish_fk_den = getDomainDensity(RVCdata_DT, "PTE VOLI", merge_protected = F)
lionfish_dt_den = getDomainDensity(RVCdata_DT, "PTE VOLI", merge_protected = F)

```

#### Opportunists 
```{r Opportunists}

opportunists_spp_list = c("CAR RUBE", "SPH BARR", "ALE CILI","DEC PUNC", "DEC MACA", "CAR CRYS", "CAR BART", "SCO REGA","SPH PICU", "CAR LATU", "SEL VOME", "ELA BIPI", "CAR SPE.", "TRA FALC", "EUT ALLE", "SER RIVO", "SCO MACU", "SER DUME", "SCO CAVA", "SPH GUAC", "CAR LUGU", "OLI SAUR", "SER SPE.", "Rac cana", "Ser zona")

#abundance
opportunists_fk_abun = getDomainAbundance(RVCdata_FK, opportunists_spp_list, merge_protected = F)
opportunists_dt_abun = getDomainAbundance(RVCdata_FK, opportunists_spp_list, merge_protected = F)

#density
opportunists_fk_den = getDomainDensity(RVCdata_DT, opportunists_spp_list, merge_protected = F)
opportunists_dt_den = getDomainDensity(RVCdata_DT, opportunists_spp_list, merge_protected = F)

```

#### Parrotfish
```{r Parrotfish}

parrotfish_spp_list = c('SCA ISER', "SCA COEL", "SPA AURO", "SPA VIRI", "SPA ATOM", "SCA TAEN", 'SPA RUBR', "SPA CHRY", "SCA VETU", "SCA COER", "SCA GUAC", "CRY ROSE", "SPA RADI", "SCA SPE.", "NIC USTA", "SPA SPE.")

#abundance
parrotfish_fk_abun = getDomainAbundance(RVCdata_FK, parrotfish_spp_list, merge_protected = F)
parrotfish_dt_abun = getDomainAbundance(RVCdata_FK, parrotfish_spp_list, merge_protected = F)

#density
parrotfish_fk_den = getDomainDensity(RVCdata_DT, parrotfish_spp_list, merge_protected = F)
parrotfish_dt_den = getDomainDensity(RVCdata_DT, parrotfish_spp_list, merge_protected = F)

```

#### Rays
```{r Rays}

rays_spp_list = c("URO JAMA", "ECH NAUC", "DAS AMER", "AET NARI", "NAR BANC", "Rhi bona")

#abundance
rays_fk_abun = getDomainAbundance(RVCdata_FK, rays_spp_list, merge_protected = F)
rays_dt_abun = getDomainAbundance(RVCdata_FK, rays_spp_list, merge_protected = F)

#density
rays_fk_den = getDomainDensity(RVCdata_DT, rays_spp_list, merge_protected = F)
rays_dt_den = getDomainDensity(RVCdata_DT, rays_spp_list, merge_protected = F)

```

#### Sea bass and Hamlets
```{r Sea bass and Hamlets}

sea_bass_hamlet_spp_list = c("SER TIGR","HYP GEMM","HYP UNIC","SER TABA","SER BALD","HYP PUEL","EPI ADSC","SER TORT","EPI GUTT","HYP NIGR","DIP FORM","HYP SPE.","SCH BETA","HYP TANN", "RYP SAPO","PAR FURC","HYP INDI","HYP GUTT","ALP AFER","LIO EUKR","SER ANNU","LIO RUBE","HYP HYBR","HYP CHLO","PRI AQUI","RYP MACU","SER SUBL","CEN OCYU","CEN STRI","Epi drum","Lio mowb")

#abundance
seabass_fk_abun = getDomainAbundance(RVCdata_FK, sea_bass_hamlet_spp_list, merge_protected = F)
seabass_dt_abun = getDomainAbundance(RVCdata_FK, sea_bass_hamlet_spp_list, merge_protected = F)

#density
seabass_fk_den = getDomainDensity(RVCdata_DT, sea_bass_hamlet_spp_list, merge_protected = F)
seabass_dt_den = getDomainDensity(RVCdata_DT, sea_bass_hamlet_spp_list, merge_protected = F)

```

#### Sharks
```{r Sharks}

sharks_spp_list = c("GIN CIRR", "CAR PERE", "CAR LEUC", "CAR LIMB", "SPH MOKA", "SPH TIBU", "CAR FALC", "SPH LEWI", "CAR OBSC", "Neg brev", "CAR PLUM", 'Gal cuvi')

#abundance
sharks_fk_abun = getDomainAbundance(RVCdata_FK, sharks_spp_list, merge_protected = F)
sharks_dt_abun = getDomainAbundance(RVCdata_FK, sharks_spp_list, merge_protected = F)

#density
sharks_fk_den = getDomainDensity(RVCdata_DT, sharks_spp_list, merge_protected = F)
sharks_dt_den = getDomainDensity(RVCdata_DT, sharks_spp_list, merge_protected = F)

```

#### Small Reef Fish
```{r Small Reef Fish}

small_reef_fish_spp_list = c()

#abundance
small_reef_fk_abun = getDomainAbundance(RVCdata_FK, small_reef_fish_spp_list, merge_protected = F)
small_reef_dt_abun = getDomainAbundance(RVCdata_FK, small_reef_fish_spp_list, merge_protected = F)

#density
small_reef_fk_den = getDomainDensity(RVCdata_DT, small_reef_fish_spp_list, merge_protected = F)
small_reef_dt_den = getDomainDensity(RVCdata_DT, small_reef_fish_spp_list, merge_protected = F)

```

#### Snapper
```{r Snapper}

snapper_spp_list = c("OCY CHRY", "LUT GRIS", "LUT ANAL", "LUT APOD", "LUT SYNA", "LUT MAHO", "LUT JOCU", "LUT BUCC", 'LUT SPE.', "LUT CYAN", "RHO AURO", "Lut camp")

#abundance
snapper_fk_abun = getDomainAbundance(RVCdata_FK, snapper_spp_list, merge_protected = F)
snapper_dt_abun = getDomainAbundance(RVCdata_FK, snapper_spp_list, merge_protected = F)

#density
snapper_fk_den = getDomainDensity(RVCdata_DT, snapper_spp_list, merge_protected = F)
snapper_dt_den = getDomainDensity(RVCdata_DT, snapper_spp_list, merge_protected = F)

```

```{r reef fish biodiversity}

```

```{r trophic levels}
#potential visualize as a stacked chart 
read_csv('/big_csv/FKNMS_infographic_list.csv')

```

```{r exploited reef fish: grouper-snapper complex}

exploited_spp_list= c(
    "LUT ANAL", #Mutton Snapper
    "LUT GRIS", #Gray Snapper        
    "OCY CHRY", #Yellowtail Snapper 
    "LUT SYNA", #Lane Snapper
    "LUT APOD", #Schoolmaster Snapper 
    "LAC MAXI", #Hogfish
    "EPI ADSC", #Rockhind
    "CEP CRUE", #Graysby
    "EPI GUTT", #Red Hind
    "EPI ITAJ", #Goliath Grouper 
    "EPI MORI", #Red Grouper
    "EPI STRI", #Nassau Grouper 
    "MYC BONA", #Black Grouper
    "MYC VENE", #Yellowfin Grouper
    "MYC PHEN", #Scamp
    "HAE AURO", #Tomtate
    "HAE MELA", #Cottonwick
    "HAE PLUM", #White Grunt
    "HAE SCIU", #Bluestriped 
    "MYC MICR" #Gag 
    )

exploited_den <- getDomainDensity(RVCdata_FK, species = exploited_spp_list, merge_protected = F)

exploited_den <- getDomainDensity(RVCdata_DT, species = exploited_spp_list, merge_protected = F)

```

```{r herbivores: parrotfish}

herbivore_spp_list= c(
  "CRY ROSE", #Bluelip Parrotfish
  "NIC USTA", #Emerald Parrotfish
  "SCA COEL", #Midnight Parrotfish
  "SCA COER", #Blue Parrotfish
  "SCA GUAC", #Rainbow Parrotfish
  "SCA ISER", #Striped Parrotfish
  "SCA SPE.", #Parrotfish Species
  "SCA TAEN", #Princess Parrotfish
  "SCA VETU", #Queen Parrotfish
  "SPA ATOM", #Greenblotch Parrotfish
  "SPA AURO", #Redband Parrotfish
  "SPA CHRY", #Redtail Parrotfish
  "SPA RADI", #Bucktooth Parrotfish
  "SPA RUBR", #Yellowtail Parrotfish
  "SPA SPE."  #Parrotfish Species
  ) 

herbivore_abun_fk <- getDomainAbundance(RVCdata_FK, species = herbivore_spp_list)

herbivore_density_fk <- getDomainDensity(RVCdata_FK, species = herbivore_spp_list)
  
```

